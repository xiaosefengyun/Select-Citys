window.LArea=function(){var e=function(){this.gearArea;this.data;this.index=0;this.value=[0,0,0]};e.prototype={init:function(e){this.params=e;this.trigger=document.querySelector(e.trigger);if(e.valueTo){this.valueTo=document.querySelector(e.valueTo)}this.keys=e.keys;this.type=e.type||1;switch(this.type){case 1:case 2:break;default:throw new Error("错误提示: 没有这种数据源类型");break}this.bindEvent()},getData:function(e){var t=this;if(typeof t.params.data=="object"){t.data=t.params.data;e()}else{var a=new XMLHttpRequest;a.open("get",t.params.data);a.onload=function(r){if(a.status>=200&&a.status<300||a.status===0){var i=JSON.parse(a.responseText);t.data=i.data;if(e){e()}}};a.send()}},bindEvent:function(){var e=this;function t(t){e.gearArea=document.createElement("div");e.gearArea.className="gearArea";e.gearArea.innerHTML='<div class="area_ctrl slideInUp">'+'<div class="area_btn_box">'+'<div class="area_btn larea_cancel">取消</div>'+'<div class="area_btn larea_finish">确定</div>'+"</div>"+'<div class="area_roll_mask">'+'<div class="area_roll">'+"<div>"+'<div class="gear area_province" data-areatype="area_province"></div>'+'<div class="area_grid">'+"</div>"+"</div>"+"<div>"+'<div class="gear area_city" data-areatype="area_city"></div>'+'<div class="area_grid">'+"</div>"+"</div>"+"<div>"+'<div class="gear area_county" data-areatype="area_county"></div>'+'<div class="area_grid">'+"</div>"+"</div>"+"</div>"+"</div>"+"</div>";document.body.appendChild(e.gearArea);a();var s=e.gearArea.querySelector(".larea_cancel");s.addEventListener("touchstart",function(t){e.close(t)});var d=e.gearArea.querySelector(".larea_finish");d.addEventListener("touchstart",function(t){e.finish(t)});var o=e.gearArea.querySelector(".area_province");var v=e.gearArea.querySelector(".area_city");var c=e.gearArea.querySelector(".area_county");o.addEventListener("touchstart",r);v.addEventListener("touchstart",r);c.addEventListener("touchstart",r);o.addEventListener("touchmove",i);v.addEventListener("touchmove",i);c.addEventListener("touchmove",i);o.addEventListener("touchend",n);v.addEventListener("touchend",n);c.addEventListener("touchend",n)}function a(){e.gearArea.querySelector(".area_province").setAttribute("val",e.value[0]);e.gearArea.querySelector(".area_city").setAttribute("val",e.value[1]);e.gearArea.querySelector(".area_county").setAttribute("val",e.value[2]);switch(e.type){case 1:e.setGearTooth(e.data);break;case 2:e.setGearTooth(e.data[0]);break}}function r(e){e.preventDefault();var t=e.target;while(true){if(!t.classList.contains("gear")){t=t.parentElement}else{break}}clearInterval(t["int_"+t.id]);t["old_"+t.id]=e.targetTouches[0].screenY;t["o_t_"+t.id]=(new Date).getTime();var a=t.getAttribute("top");if(a){t["o_d_"+t.id]=parseFloat(a.replace(/em/g,""))}else{t["o_d_"+t.id]=0}t.style.webkitTransitionDuration=t.style.transitionDuration="0ms"}function i(e){e.preventDefault();var t=e.target;while(true){if(!t.classList.contains("gear")){t=t.parentElement}else{break}}t["new_"+t.id]=e.targetTouches[0].screenY;t["n_t_"+t.id]=(new Date).getTime();var a=(t["new_"+t.id]-t["old_"+t.id])*30/window.innerHeight;t["pos_"+t.id]=t["o_d_"+t.id]+a;t.style["-webkit-transform"]="translate3d(0,"+t["pos_"+t.id]+"em,0)";t.setAttribute("top",t["pos_"+t.id]+"em");if(e.targetTouches[0].screenY<1){n(e)}}function n(e){e.preventDefault();var t=e.target;while(true){if(!t.classList.contains("gear")){t=t.parentElement}else{break}}var a=(t["new_"+t.id]-t["old_"+t.id])/(t["n_t_"+t.id]-t["o_t_"+t.id]);if(Math.abs(a)<=.2){t["spd_"+t.id]=a<0?-.08:.08}else{if(Math.abs(a)<=.5){t["spd_"+t.id]=a<0?-.16:.16}else{t["spd_"+t.id]=a/2}}if(!t["pos_"+t.id]){t["pos_"+t.id]=0}s(t)}function s(e){var t=0;var a=false;function r(){e.style.webkitTransitionDuration=e.style.transitionDuration="200ms";a=true}clearInterval(e["int_"+e.id]);e["int_"+e.id]=setInterval(function(){var i=e["pos_"+e.id];var n=e["spd_"+e.id]*Math.exp(-.03*t);i+=n;if(Math.abs(n)>.1){}else{var s=Math.round(i/2)*2;i=s;r()}if(i>0){i=0;r()}var o=-(e.dataset.len-1)*2;if(i<o){i=o;r()}if(a){var v=Math.abs(i)/2||0;d(e,v);clearInterval(e["int_"+e.id])}e["pos_"+e.id]=i;e.style["-webkit-transform"]="translate3d(0,"+i+"em,0)";e.setAttribute("top",i+"em");t++},30)}function d(t,a){a=Math.round(a);t.setAttribute("val",a);switch(e.type){case 1:e.setGearTooth(e.data);break;case 2:switch(t.dataset["areatype"]){case"area_province":e.setGearTooth(e.data[0]);break;case"area_city":var r=t.childNodes[a].getAttribute("ref");var i=[];var n=e.data[2];for(var s in n){if(s==r){i=n[s];break}};e.index=2;e.setGearTooth(i);break}}}e.getData(function(){e.trigger.addEventListener("click",t)})},setGearTooth:function(e){var t=this;var a=e||[];var r=a.length;var i=t.gearArea.querySelectorAll(".gear");var n=i[t.index].getAttribute("val");var s=r-1;if(n>s){n=s}i[t.index].setAttribute("data-len",r);if(r>0){var d=a[n][this.keys["id"]];var o;switch(t.type){case 1:o=a[n].child;break;case 2:var v=t.data[t.index+1];for(var c in v){if(c==d){o=v[c];break}};break}var l="";for(var c=0;c<r;c++){l+="<div class='tooth'  ref='"+a[c][this.keys["id"]]+"'>"+a[c][this.keys["name"]]+"</div>"}i[t.index].innerHTML=l;i[t.index].style["-webkit-transform"]="translate3d(0,"+-n*2+"em,0)";i[t.index].setAttribute("top",-n*2+"em");i[t.index].setAttribute("val",n);t.index++;if(t.index>2){t.index=0;return}t.setGearTooth(o)}else{i[t.index].innerHTML="<div class='tooth'></div>";i[t.index].setAttribute("val",0);if(t.index==1){i[2].innerHTML="<div class='tooth'></div>";i[2].setAttribute("val",0)}t.index=0}},finish:function(e){var t=this;var a=t.gearArea.querySelector(".area_province");var r=t.gearArea.querySelector(".area_city");var i=t.gearArea.querySelector(".area_county");var n=parseInt(a.getAttribute("val"));var s=a.childNodes[n].textContent;var d=a.childNodes[n].getAttribute("ref");var o=parseInt(r.getAttribute("val"));var v=r.childNodes[o].textContent;var c=r.childNodes[o].getAttribute("ref");var l=parseInt(i.getAttribute("val"));var u=i.childNodes[l].textContent;var h=i.childNodes[l].getAttribute("ref");t.trigger.value=s+(v?","+v:"")+(u?","+u:"");var _=t.trigger.id;document.getElementById(_).innerText=s+(v?","+v:"")+(u?","+u:"");t.value=[n,o,l];if(this.valueTo){this.valueTo.value=d+(c?","+c:"")+(h?","+h:"")}t.close(e)},close:function(e){e.preventDefault();var t=this;var a=new CustomEvent("input");t.trigger.dispatchEvent(a);document.body.removeChild(t.gearArea)}};return e}();